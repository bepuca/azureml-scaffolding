#!/usr/bin/env bash
#? Format and lint all Python files with Ruff and Pyright

set -eo pipefail
cd "$(dirname "$0")/../.."

source bin/env .env
bin/chkenv CODE_PATH

# Usage documentation
function usage {
    cat<<EOF
Format and lint all Python files in ${CODE_PATH} with Ruff and Pyright

Usage: $0
EOF
}

while :; do
    case $1 in
        -h|--help) usage; exit ;;
        *) break ;;
    esac
    shift
done

poetry run ruff format "$CODE_PATH"
poetry run ruff check --fix --exit-non-zero-on-fix "$CODE_PATH"
poetry run pyright "$CODE_PATH"
